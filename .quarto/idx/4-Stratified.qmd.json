{"title":"Stratified Random Sampling","markdown":{"yaml":{"title":"Stratified Random Sampling","format":"html"},"headingText":"Definisi","containsRefs":false,"markdown":"\n\n\nTujuan dari sampling dalam survei adalah memaksimumkan informasi dengan batasan biaya tertentu. Terkadang, lebih banyak informasi (atau BoE) lebih rendah dapat ditemukan dengan menggunakan **stratified random sampling**. Contoh acak berlapis diambil dengan memisahkan populasi menjadi beberapa kelompok yang tidak tumpang tindih, disebut *strata*, dan mengambil contoh acak sederhana di tiap *strata*/lapisan.\n\nSebagai ilustrasi, sebuah survei hendak dilakukan untuk menduga warga yang mendukung meningkatkan alokasi anggaran di suatu kabupaten untuk memperbaiki layanan ambulans. Di kabupaten tersebut, terdapat dua area perkotaan dan sebuah area desa. Dapat diambil contoh acak sederhana di tiap kota dan di pedesaan. Dua kota dan satu desa menjadi tiga strata di mana contoh acak sederhana diambil. Mengapa dipilih contoh acak berlapis?\n\n1. Contoh acak yang memiliki keragaman kecil di antara elemennya akan menghasilkan BoE kecil. Jika warga tiap kota memiliki opini yang mirip, sampel di tiap strata akan memiliki keragaman kecil. Misal kota A memiliki rumah sakit sehingga ambulans tidak dibutuhkan. Namun, kota B tidak memiliki rumah sakit sehingga membutuhkan ambulans. Opini yang berbeda lagi dimiliki masyarakat desa yang mungkin jauh dari fasilitas tertentu.\n2. Jika lapisan diatur sedemikian rupa sehingga surveyor lebih mudah memilih responden dan melaksanakan survei di area geografis yang dekat, biaya dapat dikurangi. \n3. Dapat melakukan pendugaan parameter untuk tiap lapisan. Misal, pemerintahan kota A ingin mengetahui opini masyarakat kota tersebut. Proporsi tersebut dapat dihitung.\n\nOleh karena itu, contoh acak berlapis dapat dipilih karena:\n\n1. Stratifikasi dapat menghasilkan BoE lebih kecil daripada contoh acak sederhana. Ini terjadi jika elemen **di dalam strata homogen** dan **antarstrata homogen**\n2. Harga pengamatan dapat dikurangi jika strata dikelompokkan sedemikian rupa sehingga memudahkan pengamatan.\n3. Penduga parameter dapat ditemukan untuk tiap strata.\n\n## Mengambil Contoh Acak Berlapis\n\nLangkah pertama dari mengambil contoh acak berlapis adalah menspesifikasi strata dan memasukkan tiap unit percontohan ke strata yang tepat. Setelah itu, ambil contoh acak sederhana di tiap strata.\n\n## Pendugaan Parameter\n\nPenduga-penduga parameter di contoh acak berlapis adalah:\n\n::: {.panel-tabset}\n## Mean\n\n$$\n\\begin{aligned}\n\\hat{\\mu}&=\\bar{y}_{st}=\\frac{1}{N}[N_1\\bar{y}_1+N_2\\bar{y}_2+\\ldots+N_L\\bar{y}_L]& \\text{(mean)}\\\\\n&=\\frac{1}{N}\\sum_{i=1}^L N_i\\bar{y}_i\\\\\n\\hat{V}(\\bar{y_{st}})&=\\frac{1}{N^2}\\left[N_1^2 V(\\bar{y_1})+N_1^2 V(\\bar{y_2})+\\ldots+N_L^2 V(\\bar{y_L})\\right]\\\\\n&=\\frac{1}{N^2}\\left[N_1^2\\left(1-\\frac{n_1}{N_1}\\right)\\frac{s_1^2}{n_1}+\\ldots\\right]\\\\\n&=\\frac{1}{N^2}\\sum_{i=1}^L N_i^2\\left(1-\\frac{n_i}{N_i}\\right)\\frac{s_i^2}{n_i}&\\text{(ragam penduga)}\\\\\\\n\\hat{\\mu}&\\pm2\\sqrt{\\hat{V}(\\bar{y})} & \\text{(selang kepercayaan)}\n\\end{aligned}\n$$\n\nBagaimana penduga tersebut diturunkan? Pertama, rata-rata dihitung di tiap strata. Namun, tidak cukup untuk menghitung rata-rata dari rata-rata. Tiap strata harusnya mendapat bobot yang berbeda karena jumlah populasi di tiap strata berbeda juga. Strata yang berkontribusi banyak ke populasi (dalam kata lain, menyusun sebagian besar dari populasi) seharusnya memiliki bobot lebih besar daripada strata yang berkontribusi sedikit. Oleh karena itu, tiap rataan strata diboboti dengan jumlah elemen di tiap strata dalam populasi.\n\nAtau, dapat diturunkan dengan menghitung total terlebih dahulu. Dugaan total tidak lain adalah pertambahan dari dugaan total tiap strata, dan dugaan total untuk strata ke-i adalah $N_i\\bar{y}_i$. Lalu, dugaan total tersebut dibagi dengan ukuran populasi sehingga jadi rata-rata. Oleh karena itu, rumus rata-rata tersebut ditemukan.\n\nKarena rataan tiap strata dianggap saling bebas jika pengacakan benar, ragam hanya perlu ditambahkan. \n\n## Total\n\n$$\n\\begin{aligned}\n\\hat{\\tau}&=N\\bar{y}_{st}=N_1\\bar{y}_1+N_2\\bar{y}_2+\\ldots+N_L\\bar{y}_L&\\\\\n&= \\sum_{i=1}^L N_i\\bar{y}_i &  \\text{(total)}\\\\\n\\hat{V}(N\\bar{y}_{st})&=N^2V(\\bar{y}_{st})\\\\ \n&=\\sum_{i=1}^L N_i^2\\left(1-\\frac{n_i}{N_i}\\right)\\frac{s_i^2}{n_i}&\\text{(ragam penduga)}\\\\\\\n\\hat{\\tau}&\\pm2\\sqrt{\\hat{V}(\\bar{Ny_{st}})} & \\text{(selang kepercayaan)}\n\\end{aligned}\n$$\n\nPenduga tersebut tidak lain penduga mean yang dikali $N$ saja.\n\n## Proporsi\n\n$$\n\\begin{aligned}\n\\hat{p_{st}}&=\\frac{1}{N}[N_1\\hat{p}_1+N_2\\hat{p}_2+\\ldots+N_L\\hat{p}_L]& \\text{(proporsi)}\\\\\n&= \\frac{1}{N}\\sum_{i=1}^L N_i\\hat{p}_i\\\\\n\\hat{V}(\\bar{y_{st}})&=\\frac{1}{N^2}\\left[N_1^2 V(\\hat{p}_1)+N_1^2 V(\\hat{p}_2)+\\ldots+N_L^2 V(\\hat{p}_L)\\right]\\\\\n&=\\frac{1}{N^2}\\left[N_1^2\\left(1-\\frac{n_1}{N_1}\\right)\\frac{\\hat{p_1}\\hat{q_1}}{n_1}+\\ldots\\right]\\\\\n &=\\frac{1}{N^2}\\sum_{i=1}^L N_i^2\\left(1-\\frac{n_i}{N_i}\\right)\\frac{\\hat{p_I}\\hat{q_I}}{n_i}&\\text{(ragam penduga)}\\\\\\\n\\hat{p}&\\pm2\\sqrt{\\hat{V}(\\hat{p})} & \\text{(selang kepercayaan)}\n\\end{aligned}\n$$\n\nSama seperti mean, tapi $s^2$ diduga dengan $pq$.\n:::\n\n### Contoh perhitungan\n\nBayangkan survei yang dijelaskan di skenario sebelumnya benar dilakukan. Dalam kata lain, dilakukan pengambilan contoh acak berlapis dari 2 kota (A dan B) serta daerah pedesaan. Objek survei adalah rata-rata jam yang dihabiskan per hari untuk menonton televisi. Lalu terkumpul data:\n\n```{r}\ntownrural <- read.csv2(\"ocrdat1.csv\") \n\ntownrural |> knitr::kable()\n```\n\nLakukan pendugaan rataan dan BoE!\n\nSetelah mendapat data, Anda dapat mengambil *screenshot* lalu memasukkan screenshot tersebut ke aplikasi optimal character recognition (OCR). OCR dapat merubah foto menjadi data Excel, seperti di website [ini](https://easypdf.com/ocr-online). Data hasil OCR mungkin belum tepat; perlu koreksi sedikit. Namun, OCR jauh lebih cepat dari memasukkan data secara manual.\n\nKasus ini akan diilustrasikan menggunakan R. Pertama, untuk menduga rataan, hitung $N_iy_i$ lalu tambahkan. Buat peubah baru, yaitu $N_iy_i$. Namun, ternyata semua peubah masih karakter:\n\n```{r}\ntownrural |> summary()\n```\n\n`dplyr::mutate(across)` dapat membantu. Fungsi ini membuat peubah baru sesuai dengan fungsi yang diinginkan:\n\n```{r}\nlibrary(dplyr)\n\ntownrural |> mutate(across(!Strata, as.numeric)) |> summary()\n```\n\nLalu buat peubah $N_iy_i$. Lakukan `mutate`, dengan fungsi `N*Mean`.\n\n```{r}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Niybari = N*Mean) |> knitr::kable()\n```\n\nJumlahkan dan bagi:\n\n```{r}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Niybari = N*Mean) |> \n    summarise(ybar = sum(Niybari)/sum(N))\n```\n\nBagaimana dengan ragam? Sama saja, buat kolom $N_i^2$, kolom faktor koreksi, dan kolom $s_i^2/n_i$. Gunakan `mutate` lagi, lalu `summarize` untuk menyimpulkan; jumlahkan kuantitas hasil kali $N_i^2$, faktor koreksi, dan $s_i^2/n_i$, lalu bagi dengan ukuran populasi kuadrat:\n\n```{r}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Nisq = N^2,\n           FK = 1-n/N,\n           sisqperni = SD^2/n) |>\n    mutate(varybar = Nisq*FK*sisqperni) |>\n    summarize(sum(varybar)/(sum(N)^2))\n```\n\nLalu buat BoE dengan cara yang sama:\n\n```{r}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Nisq = N^2,\n           FK = 1-n/N,\n           sisqperni = SD^2/n) |>\n    mutate(varybar = Nisq*FK*sisqperni) |>\n    summarize(2*sqrt(sum(varybar)/(sum(N)^2))) \n```\n\nTotal dapat dihitung dengan mengalikan rata-rata dengan ukuran populasi, dan ragam total dapat dihitung dengan mengalikan ragam rata-rata dengan ukuran populasi kuadrat.\n\n## Alokasi Ukuran Sampel\n\nSama seperti di contoh acak sederhana, filosofi dasar penentuan ukuran contoh adalah membatasi $B$ dengan membatasi $V\\left(\\bar{y}_{st}\\right)$ melalui peningkatan $n$. Rumus $V\\left(\\bar{y}_{st}\\right)$ mirip dengan rumus penduga yang dijelaskan sebelumnya, tetapi $s_i^2$ diganti $\\sigma_i^2$. Karena:\n\n$$\n\\begin{aligned}\n2\\sqrt{V\\left(\\bar{y}_{st}\\right)}&=B\\\\ \nV\\left(\\bar{y}_{st}\\right)&=\\frac{B^2}{4}\n\\end{aligned}\n$$\n\nOleh karena itu, rumus ukuran sampel:\n\n::: {.panel-tabset}\n## Mean atau Total\n\n$$\n\\begin{aligned}\nn&=\\frac{\\sum_{i=1}^L N_i^2\\sigma_i^2/a_i}{N^2D+\\sum_{i=1}^L N_i\\sigma_i^2}\n\\end{aligned}\n$$\n\n$L$ adalah jumlah strata, $a_i$ adalah proporsi observasi yang dialokasikan ke strata ke-i, $\\sigma_i^2$ adalah ragam populasi untuk strata ke-i, dan:\n\n$$\n\\begin{aligned}\nD&=\\frac{B^2}{4},& \\text{ Jika menduga }\\mu;\\\\ \nD&=\\frac{B^2}{4N^2},& \\text{ Jika menduga }\\tau\\\\ \n\\end{aligned}\n$$\n\n$\\sigma_i^2$ dapat diduga melalui $s_i^2$ dari penelitian sebelumnya. Atau, jika diketahui range dari data, dapat digunakan Teorema Tsbycheff dan sifat-sifat sebaran untuk memperkirakan bahwa range $4-6$ kali dari simpangan baku.\n\n## Proporsi\n\n$$\n\\begin{aligned}\nn&=\\frac{\\sum_{i=1}^L N_i^2p_iq_i/a_i}{N^2D+\\sum_{i=1}^L N_ip_iq_i}\n\\end{aligned}\n$$\n\n\n$L$ adalah jumlah strata, $a_i$ adalah proporsi observasi yang dialokasikan ke strata ke-i, $\\sigma_i^2$ adalah ragam populasi untuk strata ke-i, dan:\n$$\n\\begin{aligned}\nD&=\\frac{B^2}{4},& \\text{ Jika menduga }p \n\\end{aligned}\n$$\n:::\n\n### Alokasi Ukuran Sampel per Strata\n\nSetelah diketahui ukuran sampel $n$, bagaimana cara mengetahui ukuran sampel tiap strata $n_1, n_2, \\ldots, n_L$. Faktor-faktor yang perlu dipikirkan adalah:\n\n1. Jumlah total elemen tiap stratum\n2. Keragaman observasi tiap stratum\n3. Biaya untuk mencari observasi di tiap stratum\n\nJumlah elemen di tiap stratum mempengaruhi jumlah informasi di sample. Sampel dengan ukuran 20 akan memberikan lebih banyak informasi jika populasi tidak terlalu besar, misal 200 elemen daripada jika populasi sangat besar, misal 20,000 elemen. Ukuran sampel yang lebih besar harusnya dialokasikan kepada strata yang memiliki ukuran populasi lebih besar.\n\nSampel yang lebih besar dibutuhkan untuk mendapat penduga yang baik dari parameter populasi saat observasi lebih beragaman.\n\nOleh karena itu ada beberapa cara mengalokasikan ukuran sampel:\n\n::: {.panel-tabset}\n## Biaya dan Keragaman beda\n\nMenentukan ukuran sampel stratum ke-i $n_i$:\n\n$$\n\\begin{aligned}\nn_i&=n\\left(\\frac{N_i\\sigma_i/\\sqrt{c_i}}{\\sum_{k=1}^L N_k\\sigma_k/\\sqrt{c_k}}\\right)\n\\end{aligned}\n$$\n\nPerhatikan bahwa $n_i/n=a_i$. Oleh karena itu dengan melakukan susbtitusi:\n\n$$\n\\begin{aligned}\nn&=\\frac{\\sum_{i=1}^L N_i^2\\sigma_i^2\\cdot\\frac{\\sum_{i=1}^L N_k\\sigma_k/\\sqrt{c_k}} {N_i\\sigma_i/\\sqrt{c_i}}}{N^2D+\\sum_{i=1}^L N_i\\sigma_i^2}\\\\ \n&=\\frac{\\left(\\sum_{k=1}^L N_k\\sigma_k/c_k\\right)\\left(\\sum_{i=1}^L N_i\\sigma_ic_i\\right)}{N^2D+\\sum_{i=1}^L N_i\\sigma_i^2}\n\\end{aligned}\n$$\n\nDari kasus sebelumnya, anggap biaya melakukan observasi di kota A (strata 1) dan B (strata 2) sama, yaitu 9 dolar. Biaya melakukan observasi di daerah pedesaan (strata 3) 16 dolar. Dari penelitian sebelummya, diketahui $\\sigma_1\\approx 5, \\sigma_2\\approx 15, \\sigma_3\\approx 10$.\n\nPertama, lengkapi data yang dimiliki dengan ragam dan harga:\n\n```{r}\ntownrural |> \nmutate(Biaya=c(9,9,16),\n       Ragam=c(5,15,10))\n```\n\nDari data tersebut, dapat dihitung $\\sum_{i=1}^L N_i\\sigma_ic_i$ dan $\\sum_{k=1}^L N_k\\sigma_k/c_k$:\n\n```{r}\ntownrural |> \nmutate(across(!Strata, as.numeric)) |>\nmutate(Biaya=c(9,9,16), SD=c(5,15,10)) |>\nmutate(Nisigmai = N*SD^2, Nisigmaici = N*SD*sqrt(Biaya),\n       Nksigmak_perck = N*SD/sqrt(Biaya)) |>\nsummarize(sum(Nisigmai), sum(Nisigmaici), sum(Nksigmak_perck), sum(N)) |>\nknitr::kable()\n```\n\nMaka dapat dimasukkan:\n\n$$\n\\begin{aligned}\nn&=\\frac{\\left(\\sum_{k=1}^L N_k\\sigma_k/c_k\\right)\\left(\\sum_{i=1}^L N_i\\sigma_ic_i\\right)}{N^2D+\\sum_{i=1}^L N_i\\sigma_i^2}\\\\ \n&=\\frac{800.8333\\cdot 8835}{310^2\\cdot\\frac{2^2}{4}+27125}\n\\end{aligned}\n$$\n\n\n```{r}\n8835*800.8333/(310^2*(2^2/4)+27125)\n```\n\nSehingga:\n\n$n=57.418\\approx 58$. Note, dalam penentuan ukuran sampel, selalu bulatkan **ke atas**. Dapat dihitung alokasi sampel tiap strata:\n\n```{r}\ntownrural |> \nmutate(across(!Strata, as.numeric)) |>\nmutate(Biaya=c(9,9,16), SD=c(5,15,10)) |>\nmutate(ni = 58*(N*SD/sqrt(Biaya))/800.8333)\n```\n\n## Alokasi Neyman: Biaya Sama\n\nJika, biaya sama, maka:\n\n$$\n\\begin{aligned}\nn_i&=n\\left(\\frac{N_i\\sigma_i}{\\sum_{k=1}^L N_k\\sigma_k}\\right)\n\\end{aligned}\n$$\n\nSubstitusi menghasilkan:\n\n$$\n\\begin{aligned}\nn\n&=\\frac{\\left(\\sum_{k=1}^L N_k\\sigma_k\\right)^2}{N^2D+\\sum_{i=1}^L N_i\\sigma_i^2}\n\\end{aligned}\n$$\n\nDapat dibandingkan hasil alokasi Neyman dengan alokasi sebelumnya:\n\n```{r}\ntownrural |> \nmutate(across(!Strata, as.numeric)) |>\nmutate(SD=c(5,15,10)) |>\nmutate(Nisigmai = N*SD^2, Nisigmaici = N*SD) |>\nsummarize(sum(Nisigmai), sum(Nisigmaici), sum(N)) |>\nknitr::kable()\n```\n\nMasukkan ke rumus ukuran sampel total:\n\n```{r}\n2635^2/(310^2*(2^2/4)+27125)\n```\n\n$$\n\\begin{aligned}\nn\n&=\\frac{2635^2}{310^2\\cdot \\frac{2^2}{2}+27125}=56.34\\approx 57\n\\end{aligned}\n$$\n\nSelalu bulatkan ke atas. Dapat dihitung alokasi sampel tiap strata:\n\n```{r}\ntownrural |> \nmutate(across(!Strata, as.numeric)) |>\nmutate(SD=c(5,15,10)) |>\nmutate(ni = 57*(N*SD)/2635)\n```\n\nLebih banyak sampel diambil dari daerah pedesaan. Karena awalnya mahal untuk mengambil sampel dari pedesaan, ukuran sampel yang diambil lebih kecil. Jika biaya sama, maka diambil lebih banyak sampel dari pedesaan.\n\n## Alokasi Proporsional\n\nJika ragam dan biaya sama, \n\n$$\nn_i=n\\left(\\frac{N_i}{\\sum_{k=1}^L N_i}\\right)=n\\frac{N_i}{N}\n$$\n\nMaka dari itu, dengan melakukan substitusi:\n\n$$\nn=\\frac{\\sum_{i=1}^L N_i\\sigma_i^2}{ND+\\frac{1}{N}\\sum_{i=1}^LN_i\\sigma_i^2}\n$$\n\nKarena ragam sama, maka dapat diperkirakan:\n\n$$\nn=\\frac{\\sigma^2N}{ND+\\frac{\\sigma^2}{N}N}=\\frac{\\sigma^2N}{ND+\\sigma^2}\n$$\n\nMisal ragam semua sama, yaitu 10. Maka dari itu ukuran sampel:\n\n```{r}\n(10^2*310)/(310*2^2/4+10^2)\n```\n\nDan alokasi sampel tiap strata:\n\n```{r}\ntownrural |>\nmutate(across(!Strata,as.numeric)) |>\nmutate(ni = 76*N/310)\n```\n\n:::\n\nJika parameter yang diduga adalah proporsi, gunakan $p_iq_i$ untuk menduga ragam. Sama seperti sebelumnya, informasi tersebut diduga dari penelitian sebelumnya.\n\n## Beberapa tambahan\n\nContoh acak berlapis belum tentu menghasilkan BoE yang lebih rendah dari contoh acak sederhana jika keragaman dalam lapisan besar. Perhatikan contoh dalam Schaeffer halaman 140. \n\n### Post-stratification\n\nTerkadang, stratifikasi hanya dapat dilakukan setelah elemen diobservasi (data strata tidak ada di kerangka sampel). Namun, secara umum diketahui proporsi tiap strata. Lalu, ternyata proporsi tiap strata yang terkumpul di sampel tidak tepat. Dalam kasus ini, dapat dilakukan stratifikasi agar penduga merefleksikan proporsi tiap strata yang benar.\n\nTeknis dan perhitungan ragam ada di Schaeffer halaman 145."},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"4-Stratified.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","bibliography":["references.bib"],"theme":"simplex","title":"Stratified Random Sampling"},"extensions":{"book":{"multiFile":true}}}}}
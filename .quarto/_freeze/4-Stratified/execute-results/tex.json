{
  "hash": "670d799c199fb1b8e973570272c95231",
  "result": {
    "markdown": "---\ntitle: \"Stratified Random Sampling\"\nformat: html\n---\n\n\n\n## Definisi\n\nTujuan dari sampling dalam survei adalah memaksimumkan informasi dengan batasan biaya tertentu. Terkadang, lebih banyak informasi (atau BoE) lebih rendah dapat ditemukan dengan menggunakan **stratified random sampling**. Contoh acak berlapis diambil dengan memisahkan populasi menjadi beberapa kelompok yang tidak tumpang tindih, disebut *strata*, dan mengambil contoh acak sederhana di tiap *strata*/lapisan.\n\nSebagai ilustrasi, sebuah survei hendak dilakukan untuk menduga warga yang mendukung meningkatkan alokasi anggaran di suatu kabupaten untuk memperbaiki layanan ambulans. Di kabupaten tersebut, terdapat dua area perkotaan dan sebuah area desa. Dapat diambil contoh acak sederhana di tiap kota dan di pedesaan. Dua kota dan satu desa menjadi tiga strata di mana contoh acak sederhana diambil. Mengapa dipilih contoh acak berlapis?\n\n1. Contoh acak yang memiliki keragaman kecil di antara elemennya akan menghasilkan BoE kecil. Jika warga tiap kota memiliki opini yang mirip, sampel di tiap strata akan memiliki keragaman kecil. Misal kota A memiliki rumah sakit sehingga ambulans tidak dibutuhkan. Namun, kota B tidak memiliki rumah sakit sehingga membutuhkan ambulans. Opini yang berbeda lagi dimiliki masyarakat desa yang mungkin jauh dari fasilitas tertentu.\n2. Jika lapisan diatur sedemikian rupa sehingga surveyor lebih mudah memilih responden dan melaksanakan survei di area geografis yang dekat, biaya dapat dikurangi. \n3. Dapat melakukan pendugaan parameter untuk tiap lapisan. Misal, pemerintahan kota A ingin mengetahui opini masyarakat kota tersebut. Proporsi tersebut dapat dihitung.\n\nOleh karena itu, contoh acak berlapis dapat dipilih karena:\n\n1. Stratifikasi dapat menghasilkan BoE lebih kecil daripada contoh acak sederhana. Ini terjadi jika elemen **di dalam strata homogen** dan **antarstrata homogen**\n2. Harga pengamatan dapat dikurangi jika strata dikelompokkan sedemikian rupa sehingga memudahkan pengamatan.\n3. Penduga parameter dapat ditemukan untuk tiap strata.\n\n## Mengambil Contoh Acak Berlapis\n\nLangkah pertama dari mengambil contoh acak berlapis adalah menspesifikasi strata dan memasukkan tiap unit percontohan ke strata yang tepat. Setelah itu, ambil contoh acak sederhana di tiap strata.\n\n## Pendugaan Parameter\n\nPenduga-penduga parameter di contoh acak berlapis adalah:\n\n::: {.panel-tabset}\n## Mean\n\n\n\n$$\n\\begin{aligned}\n\\hat{\\mu}&=\\bar{y}_{st}=\\frac{1}{N}[N_1\\bar{y}_1+N_2\\bar{y}_2+\\ldots+N_L\\bar{y}_L]& \\text{(mean)}\\\\\n&=\\frac{1}{N}\\sum_{i=1}^L N_i\\bar{y}_i\\\\\n\\hat{V}(\\bar{y_{st}})&=\\frac{1}{N^2}\\left[N_1^2 V(\\bar{y_1})+N_1^2 V(\\bar{y_2})+\\ldots+N_L^2 V(\\bar{y_L})\\right]\\\\\n&=\\frac{1}{N^2}\\left[N_1^2\\left(1-\\frac{n_1}{N_1}\\right)\\frac{s_1^2}{n_1}+\\ldots\\right]\\\\\n&=\\frac{1}{N^2}\\sum_{i=1}^L N_i^2\\left(1-\\frac{n_i}{N_i}\\right)\\frac{s_i^2}{n_i}&\\text{(ragam penduga)}\\\\\\\n\\hat{\\mu}&\\pm2\\sqrt{\\hat{V}(\\bar{y})} & \\text{(selang kepercayaan)}\n\\end{aligned}\n$$\n\n\n\nBagaimana penduga tersebut diturunkan? Pertama, rata-rata dihitung di tiap strata. Namun, tidak cukup untuk menghitung rata-rata dari rata-rata. Tiap strata harusnya mendapat bobot yang berbeda karena jumlah populasi di tiap strata berbeda juga. Strata yang berkontribusi banyak ke populasi (dalam kata lain, menyusun sebagian besar dari populasi) seharusnya memiliki bobot lebih besar daripada strata yang berkontribusi sedikit. Oleh karena itu, tiap rataan strata diboboti dengan jumlah elemen di tiap strata dalam populasi.\n\nAtau, dapat diturunkan dengan menghitung total terlebih dahulu. Dugaan total tidak lain adalah pertambahan dari dugaan total tiap strata, dan dugaan total untuk strata ke-i adalah $N_i\\bar{y}_i$. Lalu, dugaan total tersebut dibagi dengan ukuran populasi sehingga jadi rata-rata. Oleh karena itu, rumus rata-rata tersebut ditemukan.\n\nKarena rataan tiap strata dianggap saling bebas jika pengacakan benar, ragam hanya perlu ditambahkan. \n\n## Total\n\n\n\n$$\n\\begin{aligned}\n\\hat{\\tau}&=N\\bar{y}_{st}=N_1\\bar{y}_1+N_2\\bar{y}_2+\\ldots+N_L\\bar{y}_L&\\\\\n&= \\sum_{i=1}^L N_i\\bar{y}_i &  \\text{(total)}\\\\\n\\hat{V}(N\\bar{y}_{st})&=N^2V(\\bar{y}_{st})\\\\ \n&=\\sum_{i=1}^L N_i^2\\left(1-\\frac{n_i}{N_i}\\right)\\frac{s_i^2}{n_i}&\\text{(ragam penduga)}\\\\\\\n\\hat{\\tau}&\\pm2\\sqrt{\\hat{V}(\\bar{Ny_{st}})} & \\text{(selang kepercayaan)}\n\\end{aligned}\n$$\n\n\n\nPenduga tersebut tidak lain penduga mean yang dikali $N$ saja.\n\n## Proporsi\n\n\n\n$$\n\\begin{aligned}\n\\hat{p_{st}}&=\\frac{1}{N}[N_1\\hat{p}_1+N_2\\hat{p}_2+\\ldots+N_L\\hat{p}_L]& \\text{(proporsi)}\\\\\n&= \\frac{1}{N}\\sum_{i=1}^L N_i\\hat{p}_i\\\\\n\\hat{V}(\\bar{y_{st}})&=\\frac{1}{N^2}\\left[N_1^2 V(\\hat{p}_1)+N_1^2 V(\\hat{p}_2)+\\ldots+N_L^2 V(\\hat{p}_L)\\right]\\\\\n&=\\frac{1}{N^2}\\left[N_1^2\\left(1-\\frac{n_1}{N_1}\\right)\\frac{\\hat{p_1}\\hat{q_1}}{n_1}+\\ldots\\right]\\\\\n &=\\frac{1}{N^2}\\sum_{i=1}^L N_i^2\\left(1-\\frac{n_i}{N_i}\\right)\\frac{\\hat{p_I}\\hat{q_I}}{n_i}&\\text{(ragam penduga)}\\\\\\\n\\hat{p}&\\pm2\\sqrt{\\hat{V}(\\hat{p})} & \\text{(selang kepercayaan)}\n\\end{aligned}\n$$\n\n\n\nSama seperti mean, tapi $s^2$ diduga dengan $pq$.\n:::\n\n## Contoh perhitungan\n\nBayangkan survei yang dijelaskan di skenario sebelumnya benar dilakukan. Dalam kata lain, dilakukan pengambilan contoh acak berlapis dari 2 kota (A dan B) serta daerah pedesaan. Objek survei adalah rata-rata jam yang dihabiskan per hari untuk menonton televisi. Lalu terkumpul data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntownrural <- read.csv2(\"ocrdat1.csv\") \n\ntownrural |> knitr::kable()\n```\n\n::: {.cell-output-display}\n|Strata  |N      |n     |Mean  |Median |SD    |\n|:-------|:------|:-----|:-----|:------|:-----|\n|Town A  |155.00 |20.00 |33.90 |34.50  |5.95  |\n|Town  B |62.00  |8.00  |25.12 |26.00  |15.25 |\n|Rural   |93.00  |12.00 |19.00 |17.50  |9.36  |\n:::\n:::\n\n\n\nLakukan pendugaan rataan dan BoE! Kasus ini akan diilustrasikan menggunakan R. Pertama, untuk menduga rataan, hitung $N_iy_i$ lalu tambahkan. Buat peubah baru, yaitu $N_iy_i$. Namun, ternyata semua peubah masih karakter:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntownrural |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Strata               N                  n                 Mean          \n Length:3           Length:3           Length:3           Length:3          \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n    Median               SD           \n Length:3           Length:3          \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n```\n:::\n:::\n\n\n\n`dplyr::mutate(across)` dapat membantu. Fungsi ini membuat peubah baru sesuai dengan fungsi yang diinginkan:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\ntownrural |> mutate(across(!Strata, as.numeric)) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Strata                N               n              Mean      \n Length:3           Min.   : 62.0   Min.   : 8.00   Min.   :19.00  \n Class :character   1st Qu.: 77.5   1st Qu.:10.00   1st Qu.:22.06  \n Mode  :character   Median : 93.0   Median :12.00   Median :25.12  \n                    Mean   :103.3   Mean   :13.33   Mean   :26.01  \n                    3rd Qu.:124.0   3rd Qu.:16.00   3rd Qu.:29.51  \n                    Max.   :155.0   Max.   :20.00   Max.   :33.90  \n     Median            SD        \n Min.   :17.50   Min.   : 5.950  \n 1st Qu.:21.75   1st Qu.: 7.655  \n Median :26.00   Median : 9.360  \n Mean   :26.00   Mean   :10.187  \n 3rd Qu.:30.25   3rd Qu.:12.305  \n Max.   :34.50   Max.   :15.250  \n```\n:::\n:::\n\n\n\nLalu buat peubah $N_iy_i$. Lakukan `mutate`, dengan fungsi `N*Mean`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Niybari = N*Mean) |> knitr::kable()\n```\n\n::: {.cell-output-display}\n|Strata  |   N|  n|  Mean| Median|    SD| Niybari|\n|:-------|---:|--:|-----:|------:|-----:|-------:|\n|Town A  | 155| 20| 33.90|   34.5|  5.95| 5254.50|\n|Town  B |  62|  8| 25.12|   26.0| 15.25| 1557.44|\n|Rural   |  93| 12| 19.00|   17.5|  9.36| 1767.00|\n:::\n:::\n\n\n\nJumlahkan dan bagi:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Niybari = N*Mean) |> \n    summarise(ybar = sum(Niybari)/sum(N))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    ybar\n1 27.674\n```\n:::\n:::\n\n\n\nBagaimana dengan ragam? Sama saja, buat kolom $N_i^2$, kolom faktor koreksi, dan kolom $s_i^2/n_i$. Gunakan `mutate` lagi, lalu `summarize` untuk menyimpulkan:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntownrural |> \n    mutate(across(!Strata, as.numeric)) |>\n    mutate(Nisq = N^2,\n           FK = 1-n/N,\n           sisqperni = SD^2/n) |>\n    mutate(varybar = Nisq*FK*sisqperni) |>\n    summarize(sum(varybar)/(sum(N)^2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  sum(varybar)/(sum(N)^2)\n1                1.970491\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}